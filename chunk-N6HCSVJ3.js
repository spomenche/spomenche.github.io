import{d as n,k as c,n as m}from"./chunk-KYFI25ET.js";var s=class a{setItem(t,r){try{let e=JSON.stringify(r);localStorage.setItem(t,e)}catch(e){console.error("Error saving to localStorage:",e)}}getItem(t){try{let r=localStorage.getItem(t);return r?JSON.parse(r):null}catch(r){return console.error("Error reading from localStorage:",r),null}}removeItem(t){try{localStorage.removeItem(t)}catch(r){console.error("Error removing from localStorage:",r)}}clear(){try{localStorage.clear()}catch(t){console.error("Error clearing localStorage:",t)}}hasItem(t){return localStorage.getItem(t)!==null}static \u0275fac=function(r){return new(r||a)};static \u0275prov=c({token:a,factory:a.\u0275fac,providedIn:"root"})};var u="spomenche_cart",l=class a{constructor(t){this.storageService=t;let e=this.storageService.getItem(u)||this.createEmptyCart();this.cartSubject=new n(e),this.cart$=this.cartSubject.asObservable()}cartSubject;cart$;getCart(){return this.cartSubject.value}addToCart(t,r=1){let e=this.getCart(),o=e.items.findIndex(i=>i.product.id===t.id);if(o>-1)e.items[o].quantity+=r;else{let i={product:t,quantity:r,addedAt:new Date};e.items.push(i)}this.updateCart(e)}removeFromCart(t){let r=this.getCart();r.items=r.items.filter(e=>e.product.id!==t),this.updateCart(r)}updateQuantity(t,r){if(r<=0){this.removeFromCart(t);return}let e=this.getCart(),o=e.items.findIndex(i=>i.product.id===t);o>-1&&(e.items[o].quantity=r,this.updateCart(e))}clearCart(){let t=this.createEmptyCart();this.updateCart(t)}getTotalItems(){return this.getCart().totalItems}getTotalPrice(){return this.getCart().totalPrice}isInCart(t){return this.getCart().items.some(r=>r.product.id===t)}getProductQuantity(t){let r=this.getCart().items.find(e=>e.product.id===t);return r?r.quantity:0}updateCart(t){t.totalItems=t.items.reduce((r,e)=>r+e.quantity,0),t.totalPrice=t.items.reduce((r,e)=>r+e.product.price*e.quantity,0),t.updatedAt=new Date,this.storageService.setItem(u,t),this.cartSubject.next(t)}createEmptyCart(){return{items:[],totalItems:0,totalPrice:0,updatedAt:new Date}}static \u0275fac=function(r){return new(r||a)(m(s))};static \u0275prov=c({token:a,factory:a.\u0275fac,providedIn:"root"})};export{l as a};
